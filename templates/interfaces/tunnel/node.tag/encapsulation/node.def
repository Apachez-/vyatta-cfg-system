type: txt
help: Encapsulation of this tunnel interface [REQUIRED]

syntax:expression: ((pattern $VAR(@) "^[-a-zA-Z0-9_]+$") && (exec "sudo /opt/vyatta/sbin/vyatta-encapsulation $VAR(@)"))

allowed: sudo /opt/vyatta/sbin/vyatta-encapsulation

commit:expression: (!(pattern $VAR(../local-ip/@) ".*:.*") && $VAR(@) == "gre-multipoint") || \
                   $VAR(@) != "gre-multipoint"; "IPv6 local-ip ($VAR(../local-ip/@)) is forbidden for gre-multipoint encapsulation type."

commit:expression: (!(pattern $VAR(../address/@@) ".*:.*") && $VAR(@) == "gre-multipoint") || \
                   $VAR(@) != "gre-multipoint"; "IPv6 addresses ($VAR(../address/@@)) are forbidden for gre-multipoint encapsulation type."

commit:expression:
exec "
        if [ $VAR(@) == gre-multipoint  ] && [ -n \"$VAR(../remote-ip/)\" ]; then  \
                echo \"Remote-ip shouldn't be set for mGRE mode for $VAR(../@)\";   \
                exit 1;                                                  \
        fi;                                                               \
        if [ $VAR(@) != gre-multipoint  ] && [ ! -n \"$VAR(../remote-ip/)\" ]; then  \
                echo \"Must configure the tunnel remote-ip for $VAR(../@)\";   \
                exit 1;                                                  \
        fi;

        exit 0"

create:expression: "true"
update:expression: "false" ; \
               "Encapsulation can only be set at tunnel creation for $VAR(../@)"

val_help: gre; Generic Routing Encapsulation
val_help: gre-bridge; Generic Routing Encapsulation bridge interface
val_help: gre-multipoint; Multipoint Generic Routing Encapsulation(allowed if the package vyatta-nhrp installed)
val_help: ipip; IP in IP encapsulation
val_help: sit; Simple Internet Transition encapsulation
val_help: ipip6; IP in IP6 encapsulation
val_help: ip6ip6; IP6 in IP6 encapsulation
